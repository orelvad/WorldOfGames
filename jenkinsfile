properties([pipelineTriggers([cron('0 2 * * *')])])
pipeline{
    agent any
    stages{
    stage("Checkout the repository"){
        steps{
            git "https://github.com/orelvad/WorldOfGames.git"
        }
    }
    stage("build docker image"){
        steps{
            bat "build WorldOfGames. -t orelvad/flaskk:v1.0"
        }
    }
    stage("run docker image"){
        steps{
            bat "docker-compose up"
        }
    }
    stage("Verify"){
        steps{
            bat "python e2e.py"
        }
      }
     stage("Push to Dockerhub"){
        steps{
            bat "docker tag flaskk:1.0 orelvad/flaskk:1.0"
			bat "echo $dockerhub_PSW | docker login -u $dockerhub_USR --password-stdin"
			bat "docker push orelvad/flaskk:1.0"
        }
    }
}
}